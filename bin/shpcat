#!/usr/bin/env node

var shp = require("../shp");

var reader = shp.reader(process.argv[2] || "/dev/stdin");

reader.readHeader(function(error, header) {
  if (error) throw error;
  console.log("header", header);
  process.nextTick(readRecord);
});

function readRecord() {
  reader.readRecord(function(error, record) {
    if (error) throw error;
    if (record === shp.end) return close();
    console.log("record", record);
    process.nextTick(readRecord);
  });
}

function close() {
  reader.close(function(error) {
    if (error) throw error;
    console.log("end");
  });
}
