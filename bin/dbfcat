#!/usr/bin/env node

var dbf = require("../dbf");

dbf.open(process.argv[2] || "/dev/stdin")
  .then((file) => file.header()
    .then((header) => console.log(JSON.stringify(header)))
    .then(function next() { return file.record().then((record) => record && (console.log(JSON.stringify(record)), next())); })
    .catch((error) => file.close().then(() => { throw error; }))
    .then(() => file.close()))
  .catch((error) => console.error(error.stack));
