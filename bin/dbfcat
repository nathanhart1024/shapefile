#!/usr/bin/env node

var dbf = require("../dbf");

dbf.open(process.argv[2] || "/dev/stdin")
  .then((source) => source.header()
    .then((header) => console.log(JSON.stringify(header)))
    .then(function repeat() { return source.record()
      .then((record) => record && (console.log(JSON.stringify(record)), repeat())); })
    .catch((error) => source.close().then(() => { throw error; }))
    .then(() => source.close()))
  .catch((error) => console.error(error.stack));
